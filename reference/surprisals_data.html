<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Surprisals and surprisal probabilities computed from data — surprisals.numeric • weird</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Surprisals and surprisal probabilities computed from data — surprisals.numeric"><meta name="description" content="A surprisal is given by \(s = -\log f(y)\) where \(f\) is the
density or probability mass function of the estimated or assumed distribution,
and \(y\) is an observation. This is returned by surprisals().
A surprisal probability is the probability of a surprisal at least as extreme
as \(s\). This is returned by surprisals_prob()"><meta property="og:description" content="A surprisal is given by \(s = -\log f(y)\) where \(f\) is the
density or probability mass function of the estimated or assumed distribution,
and \(y\) is an observation. This is returned by surprisals().
A surprisal probability is the probability of a surprisal at least as extreme
as \(s\). This is returned by surprisals_prob()"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weird</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/weird/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Surprisals and surprisal probabilities computed from data</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/weird/blob/main/R/surprisals_data.R" class="external-link"><code>R/surprisals_data.R</code></a></small>
      <div class="d-none name"><code>surprisals_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A surprisal is given by \(s = -\log f(y)\) where \(f\) is the
density or probability mass function of the estimated or assumed distribution,
and \(y\) is an observation. This is returned by <code><a href="surprisals.html">surprisals()</a></code>.
A surprisal probability is the probability of a surprisal at least as extreme
as \(s\). This is returned by <code><a href="surprisals.html">surprisals_prob()</a></code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'numeric'</span></span>
<span><span class="fu"><a href="surprisals.html">surprisals</a></span><span class="op">(</span><span class="va">object</span>, distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>, loo <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu"><a href="surprisals.html">surprisals</a></span><span class="op">(</span><span class="va">object</span>, distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>, loo <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu"><a href="surprisals.html">surprisals</a></span><span class="op">(</span><span class="va">object</span>, distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>, loo <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'numeric'</span></span>
<span><span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  approximation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gpd"</span>, <span class="st">"rank"</span><span class="op">)</span>,</span>
<span>  threshold_probability <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>  loo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'matrix'</span></span>
<span><span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  approximation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gpd"</span>, <span class="st">"rank"</span><span class="op">)</span>,</span>
<span>  threshold_probability <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>  loo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  approximation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gpd"</span>, <span class="st">"rank"</span><span class="op">)</span>,</span>
<span>  threshold_probability <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  distribution <span class="op">=</span> <span class="fu"><a href="dist_kde.html">dist_kde</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>  loo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A numerical data set (either a vector, matrix, or a data.frame
containing only numerical columns).</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>A distribution object. By default, a kernel density
estimate is computed from the data <code>object</code>.</p></dd>


<dt id="arg-loo">loo<a class="anchor" aria-label="anchor" href="#arg-loo"></a></dt>
<dd><p>Should leave-one-out surprisals be computed?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments are passed to the appropriate method.</p></dd>


<dt id="arg-approximation">approximation<a class="anchor" aria-label="anchor" href="#arg-approximation"></a></dt>
<dd><p>Character string specifying the method to use in
computing the surprisal probabilities. See Details below. For a multivariate
data set, it needs to be set to either "gpd" or "rank".</p></dd>


<dt id="arg-threshold-probability">threshold_probability<a class="anchor" aria-label="anchor" href="#arg-threshold-probability"></a></dt>
<dd><p>Probability threshold when computing the GPD
approximation. This is the probability below which the GPD is fitted. Only
used if <code>approximation = "gpd"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numerical vector containing the surprisals or surprisal probabilities.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The surprisal probabilities may be computed in three different ways.</p><ol><li><p>When <code>approximation = "none"</code> (the default), the surprisal probabilities are computed
using the same distribution that was used to compute the surprisal values.
Under this option, surprisal probabilities are equal to 1 minus the
coverage probability of the largest HDR that contains each value. Surprisal
probabilities smaller than 1e-6 are returned as 1e-6.</p></li>
<li><p>When <code>approximation = "gdp"</code>, the surprisal probabilities are
computed using a Generalized Pareto Distribution fitted to the most extreme
surprisal values (those with probability less than <code>threshold_probability</code>).
For surprisal probabilities greater than <code>threshold_probability</code>, the value of
<code>threshold_probability</code> is returned. Under this option, the distribution is
used for computing the surprisal values but not for determining their
probabilities. Due to extreme value theory, the resulting probabilities should
be relatively insensitive to the distribution used in computing the surprisal
values.</p></li>
<li><p>When <code>approximation = "rank"</code>, the surprisal probability of each
observation is estimated using the proportion of observations with
greater surprisal values; i.e., 1 - rank(s)/n where <code>rank(s)</code> is the rank
of the surprisal value <code>s</code> among all surprisal values, and <code>n</code> is the
number of observations. This is a nonparametric approach that is also
insensitive to the distribution used in computing the surprisal values.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rob J Hyndman (2026) "That's weird: Anomaly detection using R", Chapter 6,
<a href="https://OTexts.com/weird/" class="external-link">https://OTexts.com/weird/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dist_kde.html">dist_kde</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rob J Hyndman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Univariate data</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_kde <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="va">y</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_normal <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_zscore <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         y p_kde    p_normal    p_zscore</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  5     0     0.000<span style="text-decoration: underline;">000</span>573 0.000<span style="text-decoration: underline;">000</span>573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  0.850 0.490 0.395       0.395      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.925</span> 0.376 0.355       0.355      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  0.894 0.471 0.372       0.372      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.941</span> 0.368 0.347       0.347      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  0.539 0.637 0.590       0.590      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.182</span> 0.821 0.856       0.856      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  0.892 0.472 0.373       0.373      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  1.33  0.307 0.184       0.184      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.103</span> 0.854 0.918       0.918      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">n01</span><span class="op">$</span><span class="va">v1</span>,</span></span>
<span class="r-in"><span>  prob1 <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob2 <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="va">y</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob3 <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob4 <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="fu">dist_normal</span><span class="op">(</span><span class="op">)</span>, approximation <span class="op">=</span> <span class="st">"gpd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">prob1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        y   prob1    prob2    prob3    prob4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3.81 0.001<span style="text-decoration: underline;">50</span> 0.000<span style="text-decoration: underline;">230</span> 0.000<span style="text-decoration: underline;">139</span> 0.000<span style="text-decoration: underline;">135</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3.06 0.002<span style="text-decoration: underline;">58</span> 0.001<span style="text-decoration: underline;">89</span>  0.002<span style="text-decoration: underline;">25</span>  0.002<span style="text-decoration: underline;">61</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">3.01</span> 0.005<span style="text-decoration: underline;">09</span> 0.004<span style="text-decoration: underline;">27</span>  0.002<span style="text-decoration: underline;">63</span>  0.003<span style="text-decoration: underline;">08</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">3.00</span> 0.005<span style="text-decoration: underline;">28</span> 0.004<span style="text-decoration: underline;">41</span>  0.002<span style="text-decoration: underline;">73</span>  0.003<span style="text-decoration: underline;">20</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">2.94</span> 0.006<span style="text-decoration: underline;">20</span> 0.005<span style="text-decoration: underline;">29</span>  0.003<span style="text-decoration: underline;">28</span>  0.003<span style="text-decoration: underline;">89</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">2.89</span> 0.007<span style="text-decoration: underline;">12</span> 0.006<span style="text-decoration: underline;">22</span>  0.003<span style="text-decoration: underline;">87</span>  0.004<span style="text-decoration: underline;">61</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  2.68 0.009<span style="text-decoration: underline;">27</span> 0.008<span style="text-decoration: underline;">35</span>  0.007<span style="text-decoration: underline;">46</span>  0.009<span style="text-decoration: underline;">13</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  2.65 0.010<span style="text-decoration: underline;">2</span>  0.009<span style="text-decoration: underline;">26</span>  0.008<span style="text-decoration: underline;">07</span>  0.009<span style="text-decoration: underline;">91</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">2.60</span> 0.016<span style="text-decoration: underline;">3</span>  0.015<span style="text-decoration: underline;">2</span>   0.009<span style="text-decoration: underline;">43</span>  0.011<span style="text-decoration: underline;">6</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">2.59</span> 0.016<span style="text-decoration: underline;">4</span>  0.015<span style="text-decoration: underline;">4</span>   0.009<span style="text-decoration: underline;">53</span>  0.011<span style="text-decoration: underline;">8</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 990 more rows</span></span>
<span class="r-in"><span><span class="co"># Bivariate data</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prob <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, approximation <span class="op">=</span> <span class="st">"gpd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 50 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           x      y      prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">75</span>  5     0.000<span style="text-decoration: underline;">021</span>3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">1.56</span>    -<span style="color: #BB0000;">0.393</span> 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  0.700    0.165 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  0.301   -<span style="color: #BB0000;">0.274</span> 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.66</span>     0.476 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.491</span>    0.731 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.360</span>   -<span style="color: #BB0000;">0.736</span> 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  1.67     1.30  0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  0.941    0.420 0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  1.62     1.51  0.1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span><span class="va">oldfaithful</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span></span></span>
<span class="r-in"><span>    s <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">duration</span>, <span class="va">waiting</span><span class="op">)</span>, loo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    p <span class="op">=</span> <span class="fu"><a href="surprisals.html">surprisals_prob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">duration</span>, <span class="va">waiting</span><span class="op">)</span>, loo <span class="op">=</span> <span class="cn">TRUE</span>, approximation <span class="op">=</span> <span class="st">"gpd"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,097 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time                recorded_duration       duration waiting     s         p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 2018-04-25 <span style="color: #949494;">19:08:00</span> 1s                             1    <span style="text-decoration: underline;">5</span>700 <span style="color: #BB0000;">Inf</span>   0        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 2020-06-01 <span style="color: #949494;">21:04:00</span> 2 minutes                    120    <span style="text-decoration: underline;">6</span>060 <span style="color: #BB0000;">Inf</span>   0        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 2022-12-03 <span style="color: #949494;">16:20:00</span> ~4m                          240    <span style="text-decoration: underline;">3</span>060 <span style="color: #BB0000;">Inf</span>   0        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 2022-12-07 <span style="color: #949494;">17:19:00</span> ~4 30s                        30    <span style="text-decoration: underline;">5</span>220 <span style="color: #BB0000;">Inf</span>   0        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 2023-07-04 <span style="color: #949494;">12:03:00</span> ~1 minute 55ish seconds       60    <span style="text-decoration: underline;">4</span>920 <span style="color: #BB0000;">Inf</span>   0        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 2020-09-04 <span style="color: #949494;">01:38:00</span> &gt;1m 50s                      110    <span style="text-decoration: underline;">6</span>240  22.7 0.000<span style="text-decoration: underline;">049</span>9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 2018-09-29 <span style="color: #949494;">22:10:00</span> ~4m01s                       241    <span style="text-decoration: underline;">4</span>500  18.4 0.001<span style="text-decoration: underline;">13</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 2022-09-08 <span style="color: #949494;">05:13:00</span> 5 min                        300    <span style="text-decoration: underline;">5</span>280  18.3 0.001<span style="text-decoration: underline;">19</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 2021-01-22 <span style="color: #949494;">18:35:00</span> 2m50s                        170    <span style="text-decoration: underline;">3</span>600  17.6 0.002<span style="text-decoration: underline;">10</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 2018-07-18 <span style="color: #949494;">14:00:00</span> ~1m46s                       106    <span style="text-decoration: underline;">3</span>000  17.6 0.002<span style="text-decoration: underline;">20</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,087 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rob Hyndman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

